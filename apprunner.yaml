version: 1.0
runtime: docker
build:
  commands:
    build:
      - echo "ğŸš€ Building Better Call Buffet API for App Runner"
      - echo "ğŸ“Š Repository Pattern Architecture Ready"
      - echo "ğŸ—„ï¸ Database migrations will run on startup"
run:
  runtime-version: latest
  command: sh -c "poetry run alembic upgrade head && poetry run uvicorn app.main:app --host 0.0.0.0 --port 8000"
  network:
    port: 8000
    env:
      # Environment variables will be set in App Runner console
      - name: DATABASE_URL
        value: "postgresql://username:password@host:5432/dbname"
      - name: SECRET_KEY
        value: "your-secret-key-from-parameter-store"
  env:
    # App Runner specific optimizations
    - name: PYTHONUNBUFFERED
      value: "1"
    - name: POETRY_NO_INTERACTION
      value: "1"
